<!DOCTYPE html>
<html class="no-js" lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width,initial-scale=1" name="viewport"/>
  <meta content="Augmenting neuroimaging acquisition devices to produce analysis-grade data" name="description"/>
  <meta content="The NiPreps developers" name="author"/>
  <link href="https://www.nipreps.org/apps/framework/" rel="canonical"/>
  <link href="../../assets/images/favicon.png" rel="icon"/>
  <meta content="mkdocs-1.1.2, mkdocs-material-7.1.2" name="generator"/>
  <title>
   Introduction - NiPreps
  </title>
  <link href="../../assets/stylesheets/main.6f955dcd.min.css" rel="stylesheet"/>
  <link href="../../assets/stylesheets/palette.ef6f36e2.min.css" rel="stylesheet"/>
  <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
  <style>
   :root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}
  </style>
  <script>
   window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-170131052-1","www.nipreps.org"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})
  </script>
  <script async="" src="https://www.google-analytics.com/analytics.js">
  </script>
 </head>
 <body data-md-color-accent="none" data-md-color-primary="none" data-md-color-scheme="" dir="ltr">
  <script>
   function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}
  </script>
  <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
  <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
  <label class="md-overlay" for="__drawer">
  </label>
  <div data-md-component="skip">
   <a class="md-skip" href="#what-is-bids">
    Skip to content
   </a>
  </div>
  <div data-md-component="announce">
  </div>
  <header class="md-header" data-md-component="header">
   <nav aria-label="Header" class="md-header__inner md-grid">
    <a aria-label="NiPreps" class="md-header__button md-logo" data-md-component="logo" href="../.." title="NiPreps">
     <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z">
      </path>
     </svg>
    </a>
    <label class="md-header__button md-icon" for="__drawer">
     <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z">
      </path>
     </svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
     <div class="md-header__ellipsis">
      <div class="md-header__topic">
       <span class="md-ellipsis">
        NiPreps
       </span>
      </div>
      <div class="md-header__topic" data-md-component="header-topic">
       <span class="md-ellipsis">
        Introduction
       </span>
      </div>
     </div>
    </div>
   </nav>
  </header>
  <div class="md-container" data-md-component="container">
   <main class="md-main" data-md-component="main">
    <div class="md-main__inner md-grid">
     <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
       <div class="md-sidebar__inner">
        <nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
         <label class="md-nav__title" for="__drawer">
          <a aria-label="NiPreps" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="NiPreps">
           <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z">
            </path>
           </svg>
          </a>
          NiPreps
         </label>
         <ul class="md-nav__list" data-md-scrollfix="">
          <li class="md-nav__item">
           <a class="md-nav__link" href="../..">
            Home
           </a>
          </li>
          <li class="md-nav__item md-nav__item--nested">
           <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
           <label class="md-nav__link" for="__nav_2">
            NiPreps
            <span class="md-nav__icon md-icon">
            </span>
           </label>
           <nav aria-label="NiPreps" class="md-nav" data-md-level="1">
            <label class="md-nav__title" for="__nav_2">
             <span class="md-nav__icon md-icon">
             </span>
             NiPreps
            </label>
            <ul class="md-nav__list" data-md-scrollfix="">
             <li class="md-nav__item">
              <a class="md-nav__link" href="../../intro/nipreps/">
               Framework
              </a>
             </li>
            </ul>
           </nav>
          </li>
          <li class="md-nav__item md-nav__item--active md-nav__item--nested">
           <input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
           <label class="md-nav__link" for="__nav_3">
            BIDS-Apps
            <span class="md-nav__icon md-icon">
            </span>
           </label>
           <nav aria-label="BIDS-Apps" class="md-nav" data-md-level="1">
            <label class="md-nav__title" for="__nav_3">
             <span class="md-nav__icon md-icon">
             </span>
             BIDS-Apps
            </label>
            <ul class="md-nav__list" data-md-scrollfix="">
             <li class="md-nav__item md-nav__item--active">
              <input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
              <label class="md-nav__link md-nav__link--active" for="__toc">
               Introduction
               <span class="md-nav__icon md-icon">
               </span>
              </label>
              <a class="md-nav__link md-nav__link--active" href="./">
               Introduction
              </a>
              <nav aria-label="Table of contents" class="md-nav md-nav--secondary">
               <label class="md-nav__title" for="__toc">
                <span class="md-nav__icon md-icon">
                </span>
                Table of contents
               </label>
               <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
                <li class="md-nav__item">
                 <a class="md-nav__link" href="#what-is-bids">
                  What is BIDS?
                 </a>
                </li>
                <li class="md-nav__item">
                 <a class="md-nav__link" href="#what-is-a-bids-app">
                  What is a BIDS App?
                 </a>
                </li>
                <li class="md-nav__item">
                 <a class="md-nav__link" href="#analysis-levels">
                  Analysis levels
                 </a>
                </li>
                <li class="md-nav__item">
                 <a class="md-nav__link" href="#a-unified-command-line-interface">
                  A unified command-line interface
                 </a>
                </li>
                <li class="md-nav__item">
                 <a class="md-nav__link" href="#what-are-bids-derivatives">
                  What are BIDS Derivatives?
                 </a>
                </li>
               </ul>
              </nav>
             </li>
             <li class="md-nav__item">
              <a class="md-nav__link" href="../docker/">
               Executing with Docker
              </a>
             </li>
             <li class="md-nav__item">
              <a class="md-nav__link" href="../singularity/">
               Executing with Singularity
              </a>
             </li>
            </ul>
           </nav>
          </li>
          <li class="md-nav__item md-nav__item--nested">
           <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
           <label class="md-nav__link" for="__nav_4">
            Community
            <span class="md-nav__icon md-icon">
            </span>
           </label>
           <nav aria-label="Community" class="md-nav" data-md-level="1">
            <label class="md-nav__title" for="__nav_4">
             <span class="md-nav__icon md-icon">
             </span>
             Community
            </label>
            <ul class="md-nav__list" data-md-scrollfix="">
             <li class="md-nav__item">
              <a class="md-nav__link" href="../../community/">
               Welcome
              </a>
             </li>
             <li class="md-nav__item">
              <a class="md-nav__link" href="../../community/members/">
               Membership
              </a>
             </li>
             <li class="md-nav__item">
              <a class="md-nav__link" href="../../community/features/">
               New features
              </a>
             </li>
             <li class="md-nav__item">
              <a class="md-nav__link" href="../../community/CONTRIBUTING/">
               Contributing
              </a>
             </li>
             <li class="md-nav__item">
              <a class="md-nav__link" href="../../community/CODE_OF_CONDUCT/">
               Code of Conduct
              </a>
             </li>
            </ul>
           </nav>
          </li>
          <li class="md-nav__item md-nav__item--nested">
           <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/>
           <label class="md-nav__link" for="__nav_5">
            Developers
            <span class="md-nav__icon md-icon">
            </span>
           </label>
           <nav aria-label="Developers" class="md-nav" data-md-level="1">
            <label class="md-nav__title" for="__nav_5">
             <span class="md-nav__icon md-icon">
             </span>
             Developers
            </label>
            <ul class="md-nav__list" data-md-scrollfix="">
             <li class="md-nav__item">
              <a class="md-nav__link" href="../../devs/versions/">
               Versions Matrix
              </a>
             </li>
             <li class="md-nav__item">
              <a class="md-nav__link" href="../../devs/releases/">
               Releases
              </a>
             </li>
            </ul>
           </nav>
          </li>
         </ul>
        </nav>
       </div>
      </div>
     </div>
     <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
      <div class="md-sidebar__scrollwrap">
       <div class="md-sidebar__inner">
        <nav aria-label="Table of contents" class="md-nav md-nav--secondary">
         <label class="md-nav__title" for="__toc">
          <span class="md-nav__icon md-icon">
          </span>
          Table of contents
         </label>
         <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
          <li class="md-nav__item">
           <a class="md-nav__link" href="#what-is-bids">
            What is BIDS?
           </a>
          </li>
          <li class="md-nav__item">
           <a class="md-nav__link" href="#what-is-a-bids-app">
            What is a BIDS App?
           </a>
          </li>
          <li class="md-nav__item">
           <a class="md-nav__link" href="#analysis-levels">
            Analysis levels
           </a>
          </li>
          <li class="md-nav__item">
           <a class="md-nav__link" href="#a-unified-command-line-interface">
            A unified command-line interface
           </a>
          </li>
          <li class="md-nav__item">
           <a class="md-nav__link" href="#what-are-bids-derivatives">
            What are BIDS Derivatives?
           </a>
          </li>
         </ul>
        </nav>
       </div>
      </div>
     </div>
     <div class="md-content" data-md-component="content">
      <article class="md-content__inner md-typeset">
       <h1>
        Introduction
       </h1>
       <h2 id="what-is-bids">
        What is BIDS?
        <a class="headerlink" href="#what-is-bids" title="Permanent link">
         ¶
        </a>
       </h2>
       <p>
        <a href="https://bids.neuroimaging.io/">
         The Brain Imaging Data Structure (BIDS)
        </a>
        is a standard for organizing and describing
brain datasets, including MRI.
The common naming convention and folder structure allow researchers to easily reuse BIDS datasets, re-apply analysis protocols, and run standardized automatic data preprocessing pipelines (and particularly, BIDS Apps).
The
        <a href="https://github.com/bids-standard/bids-starter-kit">
         BIDS starter-kit
        </a>
        contains a wide collection of educational resources.
Validity of the structure can be assessed with the online
        <a href="https://bids-standard.github.io/bidsvalidator/">
         BIDS-Validator
        </a>
        .
The tree of a typical, valid (
        <em>
         BIDS-compliant
        </em>
        ) dataset is shown below:
       </p>
       <div class="highlight">
        <pre><span></span><code>ds000003/
 ├─ CHANGES
 ├─ dataset_description.json
 ├─ participants.tsv
 ├─ README
 ├─ sub-01/
 │ ├─ anat/
 │ │ ├─ sub-01_inplaneT2.nii.gz
 │ │ └─ sub-01_T1w.nii.gz
 │ └─ func/
 │ ├─ sub-01_task-rhymejudgment_bold.nii.gz
 │ └─ sub-01_task-rhymejudgment_events.tsv
 ├─ sub-02/
 ├─ sub-03/
</code></pre>
       </div>
       <h2 id="what-is-a-bids-app">
        What is a BIDS App?
        <a class="headerlink" href="#what-is-a-bids-app" title="Permanent link">
         ¶
        </a>
       </h2>
       <p>
        (Taken from the
        <a href="https://doi.org/10.1371/journal.pcbi.1005209">
         BIDS Apps paper
        </a>
        )
       </p>
       <p>
        A BIDS App is a container image capturing a neuroimaging pipeline that takes a BIDS-formatted dataset as input.
Since the input is a whole dataset, apps are able to combine multiple modalities, sessions, and/or subjects, but at the same time need to implement ways to query input datasets.
Each BIDS App has the same core set of command-line arguments, making them easy to run and integrate into automated platforms.
BIDS Apps are constructed in a way that does not depend on any software outside of the container image other than the container engine.
       </p>
       <p>
        BIDS Apps rely upon two technologies for container computing:
       </p>
       <ol>
        <li>
         <a href="https://docker.com">
          Docker
         </a>
         — for building, hosting as well as running containers on local hardware (running Windows, Mac OS X or Linux) or in the cloud.
        </li>
        <li>
         <a href="https://sylabs.io/singularity/">
          Singularity
         </a>
         — for running containers on HPCs (high-performance computing).
        </li>
       </ol>
       <p>
        BIDS Apps are deposited in the
        <a href="http://hub.docker.com">
         Docker Hub
        </a>
        repository, making them openly accessible. Each app is versioned and all of the historical versions are available to download. By reporting the BIDS App name and version in a manuscript, authors can provide others with the ability to exactly replicate their analysis workflow.
       </p>
       <p>
        Docker is used for its excellent documentation, maturity, and the Docker Hub service for storage and distribution of the images.
Docker containers are easily run on personal computers and cloud services.
However, the
        <a href="https://www.docker.com/products/container-runtime">
         Docker Runtime
        </a>
        was originally designed to run different components of web services (HTTP servers, databases etc.) using cloud resources.
Docker thus requires root or root-like permissions, as well as modern versions of Linux kernel (to perform user mapping and management of network resources); though this is not a problem in context of renting cloud resources (which are not shared with other users), it makes it difficult or impossible to use in a multi-tenant environment such as an HPC system, which is often the most cost-effective computational resource available to researchers.
       </p>
       <p>
        Singularity, on the other hand, is a unique container technology designed from the ground up with the encapsulation of binary dependencies and HPC use in mind.
Its main advantage over Docker is that it does not require root access for container execution and thus is safe to use on multi-tenant systems.
In addition, it does not require recent Linux kernel functionalities (such as namespaces, cgroups and capabilities), making it easy to install on legacy systems.
       </p>
       <h2 id="analysis-levels">
        Analysis levels
        <a class="headerlink" href="#analysis-levels" title="Permanent link">
         ¶
        </a>
       </h2>
       <p>
        BIDS Apps decouple the individual level analysis (processing of independent subjects) from group-level analyses aggregating participants.
For the analysis of individual subjects, Apps need to understand the BIDS structure of the input dataset, so that the required inputs for the designated subject are found.
Apps are designed to easily process derivatives generated by the participant-level or other Apps.
The overall workflow has an entry-point and an end-point responsible of setting-up the map-reduce tasks and the tear-down including organizing the outputs for its archiving, respectively.
Each App may implement multiple map and reduce steps.
       </p>
       <p>
        <img alt="Apps" src="../../assets/journal.pcbi.1005209.g002.png"/>
       </p>
       <h2 id="a-unified-command-line-interface">
        A unified command-line interface
        <a class="headerlink" href="#a-unified-command-line-interface" title="Permanent link">
         ¶
        </a>
       </h2>
       <p>
        To improve user experience and ability to integrate BIDS Apps into various computational platforms, each App follows a set of core command-line arguments:
       </p>
       <div class="highlight">
        <pre><span></span><code>$ &lt;entrypoint&gt; &lt;bids_dataset&gt; &lt;output_path&gt; &lt;analysis_level&gt;
</code></pre>
       </div>
       <p>
        For instance, to run
        <em>
         fMRIPrep
        </em>
        on a dataset located in
        <code>
         /data/bids_root
        </code>
        and write the outputs to
        <code>
         /data/bids_root/derivatives/
        </code>
        :
       </p>
       <div class="highlight">
        <pre><span></span><code>$ fmriprep /data/bids_root /data/bids_root/derivatives/ participant
</code></pre>
       </div>
       <p>
        In this case, we have selected to run the
        <code>
         participant
        </code>
        level (to process individual subjects).
        <em>
         fMRIPrep
        </em>
        does not have a
        <code>
         group
        </code>
        level, but other BIDS Apps may have.
For instance,
        <em>
         MRIQC
        </em>
        generates group-level reports with the following command-line:
       </p>
       <div class="highlight">
        <pre><span></span><code>$ mriqc /data/bids_root /data/bids_root/derivatives/ group
</code></pre>
       </div>
       <h2 id="what-are-bids-derivatives">
        What are
        <em>
         BIDS Derivatives
        </em>
        ?
        <a class="headerlink" href="#what-are-bids-derivatives" title="Permanent link">
         ¶
        </a>
       </h2>
       <p>
        <em>
         NiPreps
        </em>
        generate
        <em>
         derivatives
        </em>
        of the original data, and they fulfill the BIDS specification for the results of Apps that are created for subsequent consumption by other BIDS-Apps.
These derivatives must follow the BIDS Derivatives specification (
        <a href="https://bids-specification.readthedocs.io/en/derivatives/">
         draft
        </a>
        ).
An example of BIDS Derivatives filesystem tree, generated with
        <em>
         fMRIPrep
        </em>
        1.5:
        <div class="highlight">
         <pre><span></span><code>derivatives/
├── fmriprep/
│ ├── dataset_description.json
│ ├── logs
│ ├── sub-01.html
│ ├── sub-01/
│ │ ├── anat/
│ │ │ ├── sub-01_desc-brain_mask.nii.gz
│ │ │ ├── sub-01_dseg.nii.gz
│ │ │ ├── sub-01_label-GM_probseg.nii.gz
│ │ │ ├── sub-01_label-WM_probseg.nii.gz
│ │ │ ├── sub-01_label-CSF_probseg.nii.gz
│ │ │ ├── sub-01_desc-preproc_T1w.nii.gz
│ │ │ ├── sub-01_space-MNI152_desc-brain_mask.nii.gz
│ │ │ ├── sub-01_space-MNI152_dseg.nii.gz
│ │ │ ├── sub-01_space-MNI152_label-GM_probseg.nii.gz
│ │ │ ├── sub-01_space-MNI152_label-WM_probseg.nii.gz
│ │ │ ├── sub-01_space-MNI152_label-CSF_probseg.nii.gz
│ │ │ ├── sub-01_space-MNI152_desc-preproc_T1w.nii.gz
│ │ │ ├── sub-01_from-MNI152_to-T1w_mode-image_xfm.h5
│ │ │ ├── sub-01_from-T1w_to-MNI152_mode-image_xfm.h5
│ │ │ └── sub-01_from-orig_to-T1w_mode-image_xfm.txt
│ │ ├── figures/
│ │ └── func/
│ │   ├── sub-01_task-rhymejudgment_space-MNI152_boldref.nii.gz
│ │   ├── sub-01_task-rhymejudgment_space-MNI152_desc-preproc_bold.nii.gz
│ │   ├── sub-01_task-rhymejudgment_space-MNI152_desc-confounds_regressors.nii.gz
│ │   └── sub-01_task-rhymejudgment_space-MNI152_desc-brain_mask.nii.gz
│ ├── sub-02.html
│ ├── sub-02/
│ ├── sub-03.html
│ └── sub-03/
</code></pre>
        </div>
       </p>
      </article>
     </div>
    </div>
   </main>
   <footer class="md-footer">
    <nav aria-label="Footer" class="md-footer__inner md-grid">
     <a class="md-footer__link md-footer__link--prev" href="../../intro/nipreps/" rel="prev">
      <div class="md-footer__button md-icon">
       <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z">
        </path>
       </svg>
      </div>
      <div class="md-footer__title">
       <div class="md-ellipsis">
        <span class="md-footer__direction">
         Previous
        </span>
        Framework
       </div>
      </div>
     </a>
     <a class="md-footer__link md-footer__link--next" href="../docker/" rel="next">
      <div class="md-footer__title">
       <div class="md-ellipsis">
        <span class="md-footer__direction">
         Next
        </span>
        Executing with Docker
       </div>
      </div>
      <div class="md-footer__button md-icon">
       <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z">
        </path>
       </svg>
      </div>
     </a>
    </nav>
    <div class="md-footer-meta md-typeset">
     <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
       <div class="md-footer-copyright__highlight">
        Copyright © 2020
       </div>
       Made with
       <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
        Material for MkDocs
       </a>
      </div>
     </div>
    </div>
   </footer>
  </div>
  <div class="md-dialog" data-md-component="dialog">
   <div class="md-dialog__inner md-typeset">
   </div>
  </div>
  <script id="__config" type="application/json">
   {"base": "../..", "features": ["tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}
  </script>
  <script src="../../assets/javascripts/bundle.4ea5477f.min.js">
  </script>
 </body>
</html>