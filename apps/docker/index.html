
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Augmenting neuroimaging acquisition devices to produce analysis-grade data">
      
      
        <meta name="author" content="The NiPreps developers">
      
      
        <link rel="canonical" href="https://www.nipreps.org/apps/docker/">
      
      
        <link rel="prev" href="../framework/">
      
      
        <link rel="next" href="../singularity/">
      
      
      <link rel="icon" href="../../assets/nipreps_brain.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Executing with Docker - NiPreps</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#before-you-start-install-docker" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="NiPreps" class="md-header__button md-logo" aria-label="NiPreps" data-md-component="logo">
      
  <img src="../../assets/nipreps_brain.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NiPreps
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Executing with Docker
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="NiPreps" class="md-nav__button md-logo" aria-label="NiPreps" data-md-component="logo">
      
  <img src="../../assets/nipreps_brain.png" alt="logo">

    </a>
    NiPreps
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../news/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    News and Announcements
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    NiPreps
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            NiPreps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/nipreps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Framework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro/transparency/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transparency of workflows
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Community
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Community
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../community/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../community/members/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Membership
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../community/features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    New features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../community/CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../community/CODE_OF_CONDUCT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of Conduct
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../community/licensing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Licensing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Documentation (users)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Documentation (users)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    BIDS-Apps
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            BIDS-Apps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Executing with Docker
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Executing with Docker
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#before-you-start-install-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Before you start: install Docker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-images" class="md-nav__link">
    <span class="md-ellipsis">
      Docker images
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-a-niprep-with-a-lightweight-wrapper" class="md-nav__link">
    <span class="md-ellipsis">
      Running a NiPrep with a lightweight wrapper
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-a-niprep-directly-interacting-with-the-docker-engine" class="md-nav__link">
    <span class="md-ellipsis">
      Running a NiPrep directly interacting with the Docker Engine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running a NiPrep directly interacting with the Docker Engine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accessing-filesystems-in-the-host-within-the-container" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing filesystems in the host within the container
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-containers-as-a-user" class="md-nav__link">
    <span class="md-ellipsis">
      Running containers as a user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-specific-options" class="md-nav__link">
    <span class="md-ellipsis">
      Application-specific options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Resource constraints
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../singularity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Executing with Singularity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datalad/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git-Annex and DataLad within containers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../users/talks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Presentations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../users/educational/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Educational
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Documentation (devs)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Documentation (devs)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devs/devenv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer Environment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devs/versions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Versions Matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devs/releases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Releases
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#before-you-start-install-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Before you start: install Docker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-images" class="md-nav__link">
    <span class="md-ellipsis">
      Docker images
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-a-niprep-with-a-lightweight-wrapper" class="md-nav__link">
    <span class="md-ellipsis">
      Running a NiPrep with a lightweight wrapper
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-a-niprep-directly-interacting-with-the-docker-engine" class="md-nav__link">
    <span class="md-ellipsis">
      Running a NiPrep directly interacting with the Docker Engine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running a NiPrep directly interacting with the Docker Engine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accessing-filesystems-in-the-host-within-the-container" class="md-nav__link">
    <span class="md-ellipsis">
      Accessing filesystems in the host within the container
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-containers-as-a-user" class="md-nav__link">
    <span class="md-ellipsis">
      Running containers as a user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-specific-options" class="md-nav__link">
    <span class="md-ellipsis">
      Application-specific options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resource-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Resource constraints
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Executing with Docker</h1>

<div class="admonition abstract">
<p class="admonition-title">Summary</p>
<p>Here, we describe how to run <em>NiPreps</em> with Docker containers.
To illustrate the process, we will show the execution of <em>fMRIPrep</em>, but these guidelines extend to any other end-user <em>NiPrep</em>.</p>
</div>
<h2 id="before-you-start-install-docker">Before you start: install Docker<a class="headerlink" href="#before-you-start-install-docker" title="Permanent link">&para;</a></h2>
<p>Probably, the most popular framework to execute containers is <em>Docker</em>.
If you are to run a <em>NiPrep</em> on your PC/laptop, this is the <strong>RECOMMENDED</strong> way of execution.
Please make sure you follow the
<a href="https://docs.docker.com/engine/install/"><em>Docker Engine</em>'s installation instructions</a>.
You can check your installation running their <code>hello-world</code> image:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>hello-world
</code></pre></div>
<p>If you have a functional installation, then you should obtain the following output:</p>
<div class="highlight"><pre><span></span><code>Hello<span class="w"> </span>from<span class="w"> </span>Docker!
This<span class="w"> </span>message<span class="w"> </span>shows<span class="w"> </span>that<span class="w"> </span>your<span class="w"> </span>installation<span class="w"> </span>appears<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>working<span class="w"> </span>correctly.

To<span class="w"> </span>generate<span class="w"> </span>this<span class="w"> </span>message,<span class="w"> </span>Docker<span class="w"> </span>took<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>steps:
<span class="w"> </span><span class="m">1</span>.<span class="w"> </span>The<span class="w"> </span>Docker<span class="w"> </span>client<span class="w"> </span>contacted<span class="w"> </span>the<span class="w"> </span>Docker<span class="w"> </span>daemon.
<span class="w"> </span><span class="m">2</span>.<span class="w"> </span>The<span class="w"> </span>Docker<span class="w"> </span>daemon<span class="w"> </span>pulled<span class="w"> </span>the<span class="w"> </span><span class="s2">&quot;hello-world&quot;</span><span class="w"> </span>image<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>Docker<span class="w"> </span>Hub.
<span class="w">    </span><span class="o">(</span>amd64<span class="o">)</span>
<span class="w"> </span><span class="m">3</span>.<span class="w"> </span>The<span class="w"> </span>Docker<span class="w"> </span>daemon<span class="w"> </span>created<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>container<span class="w"> </span>from<span class="w"> </span>that<span class="w"> </span>image<span class="w"> </span>which<span class="w"> </span>runs<span class="w"> </span>the
<span class="w">    </span>executable<span class="w"> </span>that<span class="w"> </span>produces<span class="w"> </span>the<span class="w"> </span>output<span class="w"> </span>you<span class="w"> </span>are<span class="w"> </span>currently<span class="w"> </span>reading.
<span class="w"> </span><span class="m">4</span>.<span class="w"> </span>The<span class="w"> </span>Docker<span class="w"> </span>daemon<span class="w"> </span>streamed<span class="w"> </span>that<span class="w"> </span>output<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>Docker<span class="w"> </span>client,<span class="w"> </span>which<span class="w"> </span>sent<span class="w"> </span>it
<span class="w">    </span>to<span class="w"> </span>your<span class="w"> </span>terminal.

To<span class="w"> </span>try<span class="w"> </span>something<span class="w"> </span>more<span class="w"> </span>ambitious,<span class="w"> </span>you<span class="w"> </span>can<span class="w"> </span>run<span class="w"> </span>an<span class="w"> </span>Ubuntu<span class="w"> </span>container<span class="w"> </span>with:
<span class="w"> </span>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>ubuntu<span class="w"> </span>bash

Share<span class="w"> </span>images,<span class="w"> </span>automate<span class="w"> </span>workflows,<span class="w"> </span>and<span class="w"> </span>more<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>free<span class="w"> </span>Docker<span class="w"> </span>ID:
<span class="w"> </span>https://hub.docker.com/

For<span class="w"> </span>more<span class="w"> </span>examples<span class="w"> </span>and<span class="w"> </span>ideas,<span class="w"> </span>visit:
<span class="w"> </span>https://docs.docker.com/get-started/
</code></pre></div>
<p>After checking your <em>Docker Engine</em> is capable of running <em>Docker</em>
images, you are ready to pull your first <em>NiPreps</em> container image.</p>
<div class="admonition tip">
<p class="admonition-title">Troubleshooting</p>
<p>If you encounter issues while executing a containerized application,
it is critical to identify where the fault is sourced.
For issues emerging from the <em>Docker Engine</em>, please read the
<a href="https://docs.docker.com/desktop/troubleshoot-and-support/troubleshoot/#volumes">corresponding troubleshooting guidelines</a>.
Once verified the problem is not related to the container system,
then follow the specific application debugging guidelines.</p>
</div>
<div class="admonition danger">
<p class="admonition-title">Fix <em>Docker Desktop</em> startup issue on <em>macOS</em></p>
<p>Due to a <a href="https://www.docker.com/blog/incident-update-docker-desktop-for-mac/">recent issue</a>
affecting <em>Docker Desktop</em> versions 4.29 through 4.36,
the application may fail to start.
If affected, please follow the
<a href="https://docs.docker.com/desktop/cert-revoke-solution/">official guidelines</a> to resolve this issue.</p>
</div>
<h2 id="docker-images"><em>Docker</em> images<a class="headerlink" href="#docker-images" title="Permanent link">&para;</a></h2>
<p>For every new version of the particular <em>NiPreps</em> application that is released, a corresponding <em>Docker</em> image is generated.
The Docker image <em>becomes</em> a container when the execution engine loads the image and adds an extra layer that makes it <em>runnable</em>. In order to run <em>NiPreps</em>' <em>Docker</em> images, the <em>Docker Engine</em> must be installed.</p>
<!-- (see `installation_docker`{.interpreted-text
role="ref"}).-->

<p>Taking <em>fMRIPrep</em> to illustrate the usage, first you might want to make sure of the exact version of the tool to be used:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>docker<span class="w"> </span>pull<span class="w"> </span>nipreps/fmriprep:&lt;latest-version&gt;
</code></pre></div>
<p>You can run <em>NiPreps</em> interacting directly with the <em>Docker Engine</em> via the <code>docker run</code> interface.</p>
<h2 id="running-a-niprep-with-a-lightweight-wrapper">Running a <em>NiPrep</em> with a lightweight wrapper<a class="headerlink" href="#running-a-niprep-with-a-lightweight-wrapper" title="Permanent link">&para;</a></h2>
<p>Some <em>NiPreps</em> include a lightweight wrapper script for convenience.
That is the case of <em>fMRIPrep</em> and its <code>fmriprep-docker</code> wrapper.
Before starting, make sure you <a href="https://fmriprep.readthedocs.io/en/latest/installation.html#the-fmriprep-docker-wrapper">have the wrapper installed</a>.
When you run <code>fmriprep-docker</code>, it will generate a Docker command line for you, print it out for reporting purposes, and then execute it without further action needed, e.g.:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>fmriprep-docker<span class="w"> </span>/path/to/data/dir<span class="w"> </span>/path/to/output/dir<span class="w"> </span>participant
RUNNING:<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-it<span class="w"> </span>-v<span class="w"> </span>/path/to/data/dir:/data:ro<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>/path/to_output/dir:/out<span class="w"> </span>nipreps/fmriprep:20.2.2<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>/data<span class="w"> </span>/out<span class="w"> </span>participant
...
</code></pre></div>
<p><code>fmriprep-docker</code> implements <a href="../framework/#a-unified-command-line-interface">the unified command-line interface of <em>BIDS Apps</em></a>, and automatically translates directories into <em>Docker</em> mount points for you.</p>
<p>We have published a <a href="http://reproducibility.stanford.edu/fmriprep-tutorial-running-the-docker-image/">step-by-step tutorial</a> illustrating how to run <code>fmriprep-docker</code>.
This tutorial also provides valuable troubleshooting insights and advice on what to do after
<em>fMRIPrep</em> has run.</p>
<h2 id="running-a-niprep-directly-interacting-with-the-docker-engine">Running a <em>NiPrep</em> directly interacting with the <em>Docker Engine</em><a class="headerlink" href="#running-a-niprep-directly-interacting-with-the-docker-engine" title="Permanent link">&para;</a></h2>
<p>If you need a finer control over the container execution, or you feel comfortable with the <em>Docker Engine</em>, avoiding the extra software layer of the wrapper might be a good decision.</p>
<h3 id="accessing-filesystems-in-the-host-within-the-container">Accessing filesystems in the host within the container<a class="headerlink" href="#accessing-filesystems-in-the-host-within-the-container" title="Permanent link">&para;</a></h3>
<p>Containers are confined in a sandbox, so they can't access the data on the host
unless explicitly enabled.
The <em>Docker Engine</em> provides mounting filesystems into the container with the <code>-v</code> argument and the following syntax:
<code>-v some/path/in/host:/absolute/path/within/container:ro</code>,
where the trailing <code>:ro</code> specifies that the mount is read-only.
The mount permissions modifiers can be omitted, which means the mount
will have read-write permissions.</p>
<div class="admonition warning">
<p class="admonition-title"><em>Docker for Windows</em> requires enabling Shared Drives</p>
<p>On <em>Windows</em> installations, the <code>-v</code> argument will not work
by default because it is necessary to enable shared drives.
Please check on this <a href="https://stackoverflow.com/a/51822083">Stackoverflow post</a> how to enable them.</p>
</div>
<p>In general, you'll want to at least provide two mount-points:
one set in read-only mode for the input data and one read/write
to store the outputs:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-ti<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="hll"><span class="w">    </span>-v<span class="w"> </span>path/to/data:/data:ro<span class="w"> </span><span class="se">\ </span><span class="w">       </span><span class="c1"># read-only, for data</span>
</span><span class="hll"><span class="w">    </span>-v<span class="w"> </span>path/to/output:/out<span class="w"> </span><span class="se">\ </span><span class="w">         </span><span class="c1"># read-write, for outputs</span>
</span><span class="w">    </span>nipreps/fmriprep:&lt;latest-version&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>/data<span class="w"> </span>/out/out<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>participant
</code></pre></div>
<p>We recommend mounting a work (or scratch) directory for intermediate workflow results.
This is particularly useful for <strong>debugging</strong> or <strong>reusing pre-cached intermediate results</strong>,
but can also be useful to control where these (large) directories get created,
as the default location for files created inside a docker container may not have sufficient space.
In the case of <em>NiPreps</em>, we typically inform the <em>BIDS Apps</em>
to override the work directory by setting the <code>-w</code>/<code>--work-dir</code>
argument (please note that this is not defined by the <em>BIDS Apps</em>
specifications and it may change across applications):</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-ti<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>path/to/data:/data:ro<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>path/to/output:/out<span class="w"> </span><span class="se">\</span>
<span class="hll"><span class="w">    </span>-v<span class="w"> </span>path/to/work:/work<span class="w"> </span><span class="se">\ </span><span class="w">             </span><span class="c1"># mount from host</span>
</span><span class="w">    </span>nipreps/fmriprep:&lt;latest-version&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>/data<span class="w"> </span>/out/out<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>participant
<span class="hll"><span class="w">    </span>-w<span class="w"> </span>/work<span class="w">                             </span><span class="c1"># override default directory</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Best practices</p>
<p>The <a href="https://www.repronim.org/"><em>ReproNim</em> initiative</a>
distributes materials and documentation of best practices
for containerized execution of neuroimaging workflows.
Most of these are organized within the
<a href="https://github.com/myyoda"><em>YODA</em> (Yoda's Organigram on Data Analysis)</a> principles.</p>
<p>For example, mounting <code>$PWD</code> into <code>$PWD</code> and setting that path
as current working directory can effectively resolve many issues.
This strategy may be combined with the above suggestion about
the application's work directory as follows:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-ti<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="nv">$PWD</span>:<span class="nv">$PWD</span><span class="w"> </span><span class="se">\ </span><span class="w"> </span><span class="c1"># Mount the current directory with its own name</span>
<span class="w">    </span>-w<span class="w"> </span><span class="nv">$PWD</span><span class="w"> </span><span class="se">\ </span><span class="w">      </span><span class="c1"># DO NOT confuse with the application&#39;s work directory</span>
<span class="hll"><span class="w">    </span>nipreps/fmriprep:&lt;latest-version&gt;<span class="w"> </span><span class="se">\</span>
</span><span class="hll"><span class="w">    </span>inputs/raw-data<span class="w"> </span>outputs/fmriprep<span class="w"> </span><span class="se">\ </span><span class="w"> </span><span class="c1"># With YODA, the inputs are inside the working directory</span>
</span><span class="w">    </span>participant
<span class="w">    </span>-w<span class="w"> </span><span class="nv">$PWD</span>/work
</code></pre></div>
<p>Mounting <code>$PWD</code> may be used with YODA so that all necessary <em>parts</em>
in execution are reachable from under <code>$PWD</code>.
This effectively
(i) makes it easy to <em>transfer</em> configurations from
<em>outside</em> the container to the <em>inside</em> execution runtime;
(ii) the <em>outside</em>/<em>inside</em> filesystem trees are homologous, which
makes post-processing and orchestration easier;
(iii) execution in shared systems is easier as everything is
sort of <em>self-contained</em>.</p>
<p>In addition to mounting <code>$PWD</code>, other advanced practices
include mounting specific configuration files (for example, a
<a href="https://miykael.github.io/nipype_tutorial/notebooks/basic_execution_configuration.html"><em>Nipype</em> configuration file</a>)
into the appropriate paths within the container.</p>
</div>
<p><em>BIDS Apps</em> relying on <a href="https://www.templateflow.org"><em>TemplateFlow</em></a>
for atlas and template management may require
the <em>TemplateFlow Archive</em> be mounted from the host.
Mounting the <em>Archive</em> from the host is an effective way
to prevent multiple downloads of templates that are not bundled in the image:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-ti<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>path/to/data:/data:ro<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>path/to/output:/out<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>path/to/work:/work<span class="w"> </span><span class="se">\</span>
<span class="hll"><span class="w">    </span>-v<span class="w"> </span>path/to/tf-cache:/opt/templateflow<span class="w"> </span><span class="se">\ </span><span class="w"> </span><span class="c1"># mount from host</span>
</span><span class="hll"><span class="w">    </span>-e<span class="w"> </span><span class="nv">TEMPLATEFLOW_HOME</span><span class="o">=</span>/opt/templateflow<span class="w"> </span><span class="se">\ </span><span class="c1"># override TF home</span>
</span><span class="w">    </span>nipreps/fmriprep:&lt;latest-version&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>/data<span class="w"> </span>/out/out<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>participant
<span class="w">    </span>-w<span class="w"> </span>/work
</code></pre></div>
<div class="admonition danger">
<p class="admonition-title">Sharing the <em>TemplateFlow</em> cache can cause race conditions in parallel execution</p>
<p>When sharing the <em>TemplateFlow</em> <em>HOME</em> folder across several parallel
executions against a single filesystem, these instance will likely
attempt to fetch unavailable templates without sufficient time between
actions for the data to be fully downloaded (in other words,
data downloads will be <em>racing</em> each other).</p>
<p>To resolve this issue, you will need to make sure all necessary
templates are already downloaded within the cache folder.
If the <em>TemplateFlow Client</em> is properly installed in your system,
this is possible with the following command line
(example shows how to fully download <code>MNI152NLin2009cAsym</code>:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>templateflow<span class="w"> </span>get<span class="w"> </span>MNI152NLin2009cAsym
</code></pre></div>
</div>
<h3 id="running-containers-as-a-user">Running containers as a user<a class="headerlink" href="#running-containers-as-a-user" title="Permanent link">&para;</a></h3>
<p>By default, <em>Docker</em> will run the container with the
user id (uid) <strong>0</strong>, which is reserved for the default <strong>root</strong>
account in <em>Linux</em>.
In other words, by default <em>Docker</em> will use the superuser account
to execute the container and will write files with the corresponding
uid=0 unless configured otherwise.
Executing as superuser may result in permissions and security issues,
for example, <a href="../datalad/">with <em>DataLad</em> (discussed later)</a>.
One paramount example of permissions issues where beginners typically
run into is deleting files after a containerized execution.
If the uid is not overridden, the outputs of a containerized execution
will be owned by <strong>root</strong> and group <strong>root</strong>.
Therefore, normal users will not be able to modify the output and
superuser permissions will be required to delete data generated
by the containerized application.
Some shared systems only allow running containers as a normal user
because the user will not be able to operate on the outputs otherwise.</p>
<p>Whether the container is available with default settings,
or the execution has been customized to normal users,
running as a normal user avoids these permissions issues.
This can be achieved with
<a href="https://docs.docker.com/engine/containers/run/#user"><em>Docker</em>'s <code>-u</code>/<code>--user</code> option</a>:</p>
<div class="highlight"><pre><span></span><code>--user=[ user | user:group | uid | uid:gid | user:gid | uid:group ]
</code></pre></div>
<p>We can combine this option with <em>Bash</em>'s <code>id</code> command to ensure the current user's uid and group id (gid) are being set:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-ti<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>path/to/data:/data:ro<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>path/to/output:/out<span class="w"> </span><span class="se">\</span>
<span class="hll"><span class="w">    </span>-u<span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-u<span class="k">)</span>:<span class="k">$(</span>id<span class="w"> </span>-g<span class="k">)</span><span class="w"> </span><span class="se">\ </span><span class="w">                  </span><span class="c1"># set execution uid:gid</span>
</span><span class="w">    </span>-v<span class="w"> </span>path/to/tf-cache:/opt/templateflow<span class="w"> </span><span class="se">\ </span><span class="w"> </span><span class="c1"># mount from host</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">TEMPLATEFLOW_HOME</span><span class="o">=</span>/opt/templateflow<span class="w"> </span><span class="se">\ </span><span class="c1"># override TF home</span>
<span class="w">    </span>nipreps/fmriprep:&lt;latest-version&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>/data<span class="w"> </span>/out/out<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>participant
</code></pre></div>
<p>For example:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-ti<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/ds005:/data:ro<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/ds005/derivatives:/out<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/tmp/ds005-workdir:/work<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-u<span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-u<span class="k">)</span>:<span class="k">$(</span>id<span class="w"> </span>-g<span class="k">)</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/.cache/templateflow:/opt/templateflow<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">TEMPLATEFLOW_HOME</span><span class="o">=</span>/opt/templateflow<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>nipreps/fmriprep:&lt;latest-version&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>/data<span class="w"> </span>/out/fmriprep-&lt;latest-version&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>participant<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-w<span class="w"> </span>/work
</code></pre></div>
<h3 id="application-specific-options">Application-specific options<a class="headerlink" href="#application-specific-options" title="Permanent link">&para;</a></h3>
<p>Once the <em>Docker Engine</em> arguments are written, the remainder of the
command line follows the interface defined by the specific
<em>BIDS App</em> (for instance,
<a href="https://fmriprep.readthedocs.io/en/latest/usage.html"><em>fMRIPrep</em></a>
or <a href="https://mriqc.readthedocs.io/en/latest/usage.html#a-bids-apps-command-line-interface"><em>MRIQC</em></a>).</p>
<p>The first section of a call consists of arguments specific to <em>Docker</em>,
which configure the execution of the container:</p>
<div class="highlight"><pre><span></span><code><span class="hll">$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-ti<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
</span><span class="hll"><span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/ds005:/data:ro<span class="w"> </span><span class="se">\</span>
</span><span class="hll"><span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/ds005/derivatives:/out<span class="w"> </span><span class="se">\</span>
</span><span class="hll"><span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/tmp/ds005-workdir:/work<span class="w"> </span><span class="se">\</span>
</span><span class="hll"><span class="w">    </span>-u<span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-u<span class="k">)</span>:<span class="k">$(</span>id<span class="w"> </span>-g<span class="k">)</span><span class="w"> </span><span class="se">\</span>
</span><span class="hll"><span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/.cache/templateflow:/opt/templateflow<span class="w"> </span><span class="se">\</span>
</span><span class="hll"><span class="w">    </span>-e<span class="w"> </span><span class="nv">TEMPLATEFLOW_HOME</span><span class="o">=</span>/opt/templateflow<span class="w"> </span><span class="se">\</span>
</span><span class="w">    </span>nipreps/fmriprep:&lt;latest-version&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>/data<span class="w"> </span>/out/fmriprep-&lt;latest-version&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>participant<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-w<span class="w"> </span>/work
</code></pre></div>
<p>Then, we specify the container image that we execute:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-ti<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/ds005:/data:ro<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/ds005/derivatives:/out<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/tmp/ds005-workdir:/work<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-u<span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-u<span class="k">)</span>:<span class="k">$(</span>id<span class="w"> </span>-g<span class="k">)</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/.cache/templateflow:/opt/templateflow<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">TEMPLATEFLOW_HOME</span><span class="o">=</span>/opt/templateflow<span class="w"> </span><span class="se">\</span>
<span class="hll"><span class="w">    </span>nipreps/fmriprep:&lt;latest-version&gt;<span class="w"> </span><span class="se">\</span>
</span><span class="w">    </span>/data<span class="w"> </span>/out/fmriprep-&lt;latest-version&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>participant<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-w<span class="w"> </span>/work
</code></pre></div>
<p>Finally, the application-specific options can be added.
We already described the work directory setting before, in the case
of <em>NiPreps</em> such as <em>MRIQC</em> and <em>fMRIPrep</em>.
Some options are <em>BIDS Apps</em> standard, such as
the <em>analysis level</em> (<code>participant</code> or <code>group</code>)
and specific participant identifier(s) (<code>--participant-label</code>):</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-ti<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/ds005:/data:ro<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/ds005/derivatives:/out<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/tmp/ds005-workdir:/work<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-u<span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-u<span class="k">)</span>:<span class="k">$(</span>id<span class="w"> </span>-g<span class="k">)</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="nv">$HOME</span>/.cache/templateflow:/opt/templateflow<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">TEMPLATEFLOW_HOME</span><span class="o">=</span>/opt/templateflow<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>nipreps/fmriprep:&lt;latest-version&gt;<span class="w"> </span><span class="se">\</span>
<span class="hll"><span class="w">    </span>/data<span class="w"> </span>/out/fmriprep-&lt;latest-version&gt;<span class="w"> </span><span class="se">\</span>
</span><span class="hll"><span class="w">    </span>participant<span class="w"> </span><span class="se">\</span>
</span><span class="hll"><span class="w">    </span>--participant-label<span class="w"> </span><span class="m">001</span><span class="w"> </span><span class="m">002</span><span class="w"> </span><span class="se">\</span>
</span><span class="hll"><span class="w">    </span>-w<span class="w"> </span>/work
</span></code></pre></div>
<h3 id="resource-constraints">Resource constraints<a class="headerlink" href="#resource-constraints" title="Permanent link">&para;</a></h3>
<p><em>Docker</em> may be executed with limited resources.
Please <a href="https://docs.docker.com/engine/containers/resource_constraints/">read the documentation</a>
to limit resources such as memory, memory policies, number of CPUs, etc.</p>
<p><strong>Memory will be a common culprit</strong> when working with large datasets
(+10GB).
However, the <em>Docker Engine</em> is limited to 2GB of RAM by default
for some installations of <em>Docker</em> for <em>MacOSX</em> and <em>Windows</em>.
The general resource settings can be also modified through the <em>Docker Desktop</em>
graphical user interface.
On a shell, the memory limit can be overridden with:</p>
<div class="highlight"><pre><span></span><code>$ service docker stop
$ dockerd --storage-opt dm.basesize=30G
</code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2020
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs.link"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>